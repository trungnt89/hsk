- CÃ³ 6 Ä‘á» Ä‘á»ƒ lá»±a chá»n, náº¿u Ä‘Ã£ select thÃ¬ lÆ°u láº¡i giÃ¡ trá»‹ Ä‘á»ƒ sá»­ dá»¥ng cho láº§n sau
-Ghi láº¡i cÃ¡c tráº¡ng thÃ¡i chá»n select button
-3 tráº¡ng thÃ¡i cá»§a cÃ¢u há»i Dá»… - VÃ¹a - KhÃ³ khÃ´ng cho phÃ©p scroll
-Tráº¡ng thÃ¡i chá»n Ä‘Ã¡p Ã¡n Ä‘Æ°á»£c lÆ°u láº¡i,clich Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i 2 tráº¡ng thÃ¡i  [Ä‘Ã£ tráº£ lá»i/chÆ°a tráº£] lá»i Ä‘á»ƒ hiá»ƒn thá»‹ khi chá»n button trÃªn TOP.Cháº¿ Ä‘á»™ "Toggle" (Báº­t/Táº¯t):
-CÃ³ chá»— Ä‘á»ƒ ghi chÃº cho cÃ¢u há»i
-Sá»­ dá»¥ng google tranlate dá»‹ch sang tiáº¿ng viá»‡t khi bÃ´i Ä‘en text,hiá»ƒn thá»‹ dá»‹ch trÃªn mÃ n hÃ¬nh thay vÃ¬ tooltip
-LÆ°u láº¡i cÃ¡c tráº¡ng thÃ¡i click button, select Ä‘á»ƒ dÃ¹ng cho láº§n sau 
-3 tráº¡ng thÃ¡i Dá»… - Vá»«a - KhÃ³ á»Ÿ gÃ³c pháº£i cÃ¢u há»i thÃ¬ khi click tráº¡ng thÃ¡i select Ä‘Æ°á»£c lÃ m ná»•i báº­t, ko biáº¿n máº¥t khi click, khÃ´ng biáº¿n máº¥t khi click dÃ¹ á»Ÿ báº¥t ká»³ view nÃ o
-Chá»‰ 3 button hiá»ƒn trÃªn top lÃ  : Má»›i(tá»•ng sá»‘ cÃ¢u) / ÄÃ£ Há»c(tá»•ng sá»‘ cÃ¢u) / ChÆ°a há»c(tá»•ng sá»‘ cÃ¢u)
-6 button dÆ°á»›i cÃ¹ng lÃ  : LÃ¹i -Hiá»‡n Ä‘Ã¡p Ã¡n - Dá»…(tá»•ng sá»‘ cÃ¢u) - VÃ¹a(tá»•ng sá»‘ cÃ¢u) - khÃ³ (tá»•ng sá»‘ cÃ¢u)  -- Tiáº¿n, cÃ¡c button khi click thÃ¬ tráº¡ng thÃ¡i selected Ä‘Æ°á»£c lÃ m ná»•i báº­t,button cÃ³ viá»n 
5.Vuá»‘t chuyá»ƒn trang theo kiá»ƒu bÄƒng chuyá»n


git add . ;  git commit -m "SRC change" ; git push;



ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³
NGHIÃŠM Cáº¤M má»i hÃ nh vi sá»­a code ngoÃ i pháº¡m vi yÃªu cáº§u , sá»­ dá»¥ng git diff Ä‘á»ƒ check cho tÃ´i xem vÃ  phÃª duyá»‡t
chá»‰ thá»±c hiá»‡n yÃªu cáº§u dÆ°á»›i Ä‘Ã¢y, náº¿u báº¡n sá»­a src ngoÃ i pháº¡m vi yÃªu cáº§u tÃ´i sáº½ kiá»‡n báº¡n 
ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³ğŸ”³
1. TrÃªn mobile bá»‹ che. hÃ£y sá»­a Ä‘á»ƒ hiá»ƒn thá»‹ 100%. cho background cá»§a khá»‘i mÃ u trong Ä‘á»ƒ nhÃ¬n tháº¥y áº£nh ná»n,áº£nh ná»n váº«n pháº£i rÃµ, chá»‰ lÃ  lÃ m trong suá»‘t hoáº·c má» nháº¹ div náº±m trÃªn áº£nh ná»n



-------------------
Src gá»‘c cáº§n sá»­a:
-------------------
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pomodoro Pro - Ambient Analytics</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom"></script>
    <style>
        :root {
            --work-bg: #fff5f5; --work-color: #ff5e57;
            --break-bg: #f0fff4; --break-color: #1dd1a1;
            --dark: #1a2a6c; --gray: #95a5a6;
            --work-img: url('https://images.unsplash.com/photo-1499750310107-5fef28a66643?auto=format&fit=crop&q=80&w=1000');
            --break-img: url('https://images.unsplash.com/photo-1473116763249-2faaef81ccda?auto=format&fit=crop&q=80&w=1000');
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0; padding: 15px; display: flex; justify-content: center; align-items: center;
            background-color: #f7f9fb; background-size: cover; background-position: center; transition: 0.5s;
            min-height: 100vh; overflow-x: hidden;
        }

        .app-card, .history-card {
            background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px);
            /* Thu nhá» chiá»u rá»™ng vÃ  cÄƒn giá»¯a */
            width: 95%; max-width: 450px; padding: 25px; border-radius: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1); text-align: center;
        }

        .app-card { 
            min-height: auto; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
        }

        .history-card { 
            display: none; 
            overflow-y: auto;
            max-height: 95vh;
        }

        .timer-display { font-size: 5rem; font-weight: 800; color: var(--dark); margin: 5px 0; letter-spacing: -2px; }
        
        .main-btn { width: 100%; padding: 15px; font-size: 1.1rem; font-weight: 700; border: none; border-radius: 20px; cursor: pointer; transition: 0.2s; margin-top: 8px; color: white; }
        #startBtn { background: var(--dark); }
        .btn-reset { background: #27ae60; }
        .btn-stop { background: #e67e22; }
        .btn-mock { background: #8e44ad; }

        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); 
            display: none; justify-content: center; align-items: center; z-index: 9999; backdrop-filter: blur(10px); }
        .alarm-box { background: white; padding: 40px; border-radius: 40px; text-align: center; width: 85%; max-width: 400px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        .btn-alarm-off { background: var(--work-color); animation: pulse 1s infinite; margin-top: 20px; box-shadow: 0 10px 20px rgba(255,94,87,0.4); }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .input-group { display: flex; flex-direction: column; text-align: left; }
        .input-group label { font-size: 9px; font-weight: 800; color: var(--gray); margin-bottom: 3px; }
        select { padding: 10px; border-radius: 12px; border: 2px solid #eee; background: white; font-weight: 600; cursor: pointer; font-size: 12px; overflow: hidden; text-overflow: ellipsis; }

        .stats-summary { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .stat-box { background: rgba(255,255,255,0.8); padding: 12px; border-radius: 15px; border: 1px solid #eee; }
        .stat-box small { color: var(--gray); display: block; font-size: 10px; font-weight: bold; margin-bottom: 3px; }
        .stat-box b { color: var(--dark); font-size: 14px; display: block; }
        .stat-box i { font-style: normal; font-size: 11px; color: #ff5e57; font-weight: bold; }

        .chart-container { position: relative; height: 300px; width: 100%; margin-top: 10px; }
        
        body.work-mode { background-image: var(--work-img); }
        body.break-mode { background-image: var(--break-img); }

        #historyLog::-webkit-scrollbar { width: 5px; }
        #historyLog::-webkit-scrollbar-thumb { background: #eee; border-radius: 10px; }
    </style>
</head>
<body class="work-mode">

<div id="alarmOverlay" class="overlay">
    <div class="alarm-box">
        <h2 id="alarmMsg" style="color: var(--dark); margin: 0;">THÃ”NG BÃO</h2>
        <p style="color: var(--gray); font-weight: 600;">Vui lÃ²ng xÃ¡c nháº­n Ä‘á»ƒ tiáº¿p tá»¥c</p>
        <button class="main-btn btn-alarm-off" onclick="stopAlarm()">Táº®T CHUÃ”NG & XÃC NHáº¬N</button>
    </div>
</div>

<div class="app-card">
    <div id="status" style="font-weight: 800; color: var(--gray); letter-spacing: 2px; font-size: 0.9rem;">POMODORO PRO</div>
    <div class="timer-display" id="timer">25:00</div>

    <button id="startBtn" class="main-btn" onclick="toggleTimer()">Báº®T Äáº¦U</button>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <button class="main-btn btn-reset" onclick="resetTimer()">Äáº·t láº¡i</button>
        <button class="main-btn btn-stop" onclick="stopTimer()">Dá»«ng</button>
    </div>

    <button class="main-btn" style="background: var(--gray); margin-top: 15px;" onclick="toggleView()">ğŸ“Š XEM THá»NG KÃŠ</button>

    <div class="settings-grid">
        <div class="input-group">
            <label>THá»œI GIAN Há»ŒC (PHÃšT)</label>
            <select id="workTime" onchange="updateTimeSetting('work', this.value)">
                <option value="0.0833">5 giÃ¢y (Test)</option>
                <option value="15">15 phÃºt</option>
                <option value="25" selected>25 phÃºt</option>
                <option value="45">45 phÃºt</option>
                <option value="60">60 phÃºt</option>
                <option value="90">90 phÃºt</option>
            </select>
        </div>
        <div class="input-group">
            <label>THá»œI GIAN NGHá»ˆ (PHÃšT)</label>
            <select id="breakTime" onchange="updateTimeSetting('break', this.value)">
                <option value="0.0833">5 giÃ¢y (Test)</option>
                <option value="5" selected>5 phÃºt</option>
                <option value="10">10 phÃºt</option>
                <option value="15">15 phÃºt</option>
                <option value="20">20 phÃºt</option>
            </select>
        </div>
        <div class="input-group">
            <label>Ã‚M THANH Há»ŒC</label>
            <select id="workMusic" onchange="previewMusic(this.value, 'workMusic')">
                <option value="none">Táº¯t nháº¡c</option>
                <option value="https://cdn.pixabay.com/download/audio/2024/05/13/audio_6abbc49727.mp3?filename=stream-208813.mp3">Suá»‘i cháº£y 1</option>
                <option value="https://cdn.pixabay.com/download/audio/2023/08/09/audio_7931fcfaa5.mp3?filename=baseline-ambience-music-nearby-a-mountain-stream-161392.mp3">Suá»‘i nÃºi 2</option>
                <option value="https://cdn.pixabay.com/download/audio/2025/11/09/audio_3b45b446fa.mp3?filename=mountain-stream-433499.mp3">DÃ²ng suá»‘i 3</option>
            </select>
        </div>
        <div class="input-group">
            <label>Ã‚M THANH NGHá»ˆ</label>
            <select id="breakMusic" onchange="previewMusic(this.value, 'breakMusic')">
                <option value="none">Táº¯t nháº¡c</option>
                <option value="https://cdn.pixabay.com/download/audio/2024/05/13/audio_6abbc49727.mp3?filename=stream-208813.mp3">Suá»‘i cháº£y 1</option>
                <option value="https://cdn.pixabay.com/download/audio/2023/08/09/audio_7931fcfaa5.mp3?filename=baseline-ambience-music-nearby-a-mountain-stream-161392.mp3">Suá»‘i nÃºi 2</option>
                <option value="https://cdn.pixabay.com/download/audio/2025/11/09/audio_3b45b446fa.mp3?filename=mountain-stream-433499.mp3">DÃ²ng suá»‘i 3</option>
            </select>
        </div>
    </div>
</div>

<div class="history-card">
    <h3 style="margin:0; color: var(--dark)">ğŸ“ˆ XU HÆ¯á»šNG HIá»†U SUáº¤T</h3>
    
    <div class="stats-summary">
        <div class="stat-box">
            <small>ğŸ† CAO NHáº¤T</small>
            <b id="maxDay">-</b>
            <i id="maxVal">00:00:00</i>
        </div>
        <div class="stat-box">
            <small>ğŸ“‰ THáº¤P NHáº¤T</small>
            <b id="minDay">-</b>
            <i id="minVal">00:00:00</i>
        </div>
    </div>
    <div class="chart-container">
        <canvas id="pomoChart"></canvas>
    </div>

    <div id="historyLog" style="margin-top: 15px; text-align: left; max-height: 180px; overflow-y: auto; border-top: 1px solid #eee; padding-top: 10px;">
        <small style="color: var(--gray); font-weight: 800; display: block; margin-bottom: 8px;">CHI TIáº¾T Lá»ŠCH Sá»¬</small>
        <table style="width: 100%; font-size: 12px; color: var(--dark); border-collapse: collapse;">
            <tbody id="historyTableBody"></tbody>
        </table>
    </div>

    <button class="main-btn btn-mock" style="margin-top: 15px;" onclick="generateMockData()">GIáº¢ Láº¬P 100 NGÃ€Y Dá»® LIá»†U</button>
    
    <button class="main-btn" style="background: var(--dark); margin-top: 10px;" onclick="toggleView()">â¬…ï¸ QUAY Láº I TIMER</button>
</div>

<audio id="bgAudio" loop></audio>
<audio id="alarmAudio"><source src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

<script>
    let timer, isRunning = false, isWorkMode = true, timeLeft = 1500;
    let db, myChart, alarmInterval;
    const APP_KEY = "pomodoro_app_data";
    const bgAudio = document.getElementById('bgAudio');
    let appSettings = { workTime: 25, breakTime: 5, workMusic: 'none', breakMusic: 'none' };

    function btnVibrate() { if (navigator.vibrate) navigator.vibrate(50); }

    function toggleView() {
        btnVibrate();
        const timerPage = document.querySelector('.app-card');
        const statsPage = document.querySelector('.history-card');
        
        if (timerPage.style.display === 'none') {
            timerPage.style.display = 'flex';
            statsPage.style.display = 'none';
        } else {
            timerPage.style.display = 'none';
            statsPage.style.display = 'block';
            getAppData().then(d => renderChart(d.totalMinutes || {}));
        }
    }

    function formatTime(totalMinutes) {
        if (!totalMinutes || totalMinutes === 0) return "00:00:00";
        const h = Math.floor(totalMinutes / 60);
        const m = Math.floor(totalMinutes % 60);
        const s = Math.round((totalMinutes * 60) % 60);
        return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
    }

    const request = indexedDB.open("PomoUnifiedDB", 1);
    request.onupgradeneeded = (e) => {
        db = e.target.result;
        if (!db.objectStoreNames.contains("app_data")) db.createObjectStore("app_data");
    };
    request.onsuccess = (e) => {
        db = e.target.result;
        loadAndRender();
    };

    async function loadAndRender() {
        const data = await getAppData();
        if (data.settings) {
            appSettings = data.settings;
            document.getElementById('workTime').value = appSettings.workTime;
            document.getElementById('breakTime').value = appSettings.breakTime;
            document.getElementById('workMusic').value = appSettings.workMusic;
            document.getElementById('breakMusic').value = appSettings.breakMusic;
            timeLeft = Math.round(appSettings.workTime * 60);
            updateDisplay();
        }
        renderChart(data.totalMinutes || {});
        calculateStats(data.totalMinutes || {});
    }

    function getAppData() {
        return new Promise((res) => {
            const tx = db.transaction("app_data", "readonly");
            const store = tx.objectStore("app_data");
            const req = store.get(APP_KEY);
            req.onsuccess = () => res(req.result ? JSON.parse(req.result) : { totalMinutes:{}, settings: appSettings });
        });
    }

    async function saveAppData(newData) {
        const currentData = await getAppData();
        const mergedData = { ...currentData, ...newData };
        const tx = db.transaction("app_data", "readwrite");
        tx.objectStore("app_data").put(JSON.stringify(mergedData), APP_KEY);
    }

    function updateTimeSetting(type, val) {
        btnVibrate();
        if (type === 'work') appSettings.workTime = parseFloat(val);
        else appSettings.breakTime = parseFloat(val);
        saveAppData({ settings: appSettings });
        if (!isRunning) resetTimer();
    }

    function toggleTimer() {
        btnVibrate();
        if (!isRunning) {
            isRunning = true;
            document.getElementById('alarmAudio').load(); 
            playModeMusic();
            document.getElementById('startBtn').textContent = "Táº M Dá»ªNG";
            timer = setInterval(() => {
                timeLeft--;
                updateDisplay();
                if (timeLeft <= 0) { clearInterval(timer); triggerAlarm(); }
            }, 1000);
        } else { stopTimer(); }
    }

    function playModeMusic() {
        const musicUrl = isWorkMode ? appSettings.workMusic : appSettings.breakMusic;
        if (musicUrl && musicUrl !== 'none') {
            bgAudio.src = musicUrl;
            bgAudio.play().catch(() => console.log("Interaction required for audio"));
        } else {
            bgAudio.pause();
        }
    }

    function stopTimer() {
        clearInterval(timer);
        isRunning = false;
        bgAudio.pause();
        document.getElementById('startBtn').textContent = isWorkMode ? "Báº®T Äáº¦U" : "TIáº¾P Tá»¤C";
    }

    function resetTimer() {
        btnVibrate();
        clearInterval(timer); isRunning = false;
        bgAudio.pause();
        timeLeft = Math.round((isWorkMode ? appSettings.workTime : appSettings.breakTime) * 60);
        updateDisplay();
        document.getElementById('startBtn').textContent = "Báº®T Äáº¦U";
    }

    function triggerAlarm() {
        bgAudio.pause();
        const alarm = document.getElementById('alarmAudio');
        alarm.loop = true;
        alarm.play().catch(() => {});
        alarmInterval = setInterval(() => { if (navigator.vibrate) navigator.vibrate(500); }, 1000);
        document.getElementById('alarmMsg').textContent = isWorkMode ? "Háº¾T GIá»œ Há»ŒC Rá»’I!" : "Háº¾T GIá»œ NGHá»ˆ Rá»’I!";
        document.getElementById('alarmOverlay').style.display = 'flex';

        window.stopAlarm = () => {
            clearInterval(alarmInterval);
            alarm.pause();
            alarm.currentTime = 0;
            document.getElementById('alarmOverlay').style.display = 'none';
            
            if (isWorkMode) {
                recordSession();
                isWorkMode = false;
                document.body.className = 'break-mode';
                document.getElementById('status').textContent = 'ÄANG NGHá»ˆ NGÆ I';
                resetTimer();
                toggleTimer(); 
            } else {
                isWorkMode = true;
                document.body.className = 'work-mode';
                document.getElementById('status').textContent = 'Sáº´N SÃ€NG Há»ŒC';
                resetTimer();
            }
        };
    }

    async function recordSession() {
        const dateStr = new Date().toLocaleDateString('sv-SE');
        const data = await getAppData();
        data.totalMinutes[dateStr] = (data.totalMinutes[dateStr] || 0) + appSettings.workTime;
        await saveAppData({ totalMinutes: data.totalMinutes });
        loadAndRender();
    }

    function updateDisplay() {
        const m = Math.floor(timeLeft / 60), s = timeLeft % 60;
        document.getElementById('timer').textContent = `${m}:${s < 10 ? '0'+s : s}`;
    }

    function previewMusic(url, id) {
        appSettings[id] = url;
        saveAppData({ settings: appSettings });
        if (isRunning) playModeMusic();
        else if (url === 'none') bgAudio.pause(); 
        else { bgAudio.src = url; bgAudio.play().catch(()=>{}); }
    }

    function calculateStats(minutesObj) {
        const entries = Object.entries(minutesObj);
        if (entries.length === 0) return;
        const sorted = [...entries].sort((a, b) => b[1] - a[1]);
        document.getElementById('maxDay').textContent = sorted[0][0];
        document.getElementById('maxVal').textContent = formatTime(sorted[0][1]);
        
        const minSorted = [...entries].sort((a, b) => a[1] - b[1]);
        document.getElementById('minDay').textContent = minSorted[0][0];
        document.getElementById('minVal').textContent = formatTime(minSorted[0][1]);
        renderHistoryTable(minutesObj);
    }

    function renderHistoryTable(minutesObj) {
        const body = document.getElementById('historyTableBody');
        const sortedKeys = Object.keys(minutesObj).sort().reverse();
        body.innerHTML = sortedKeys.map(date => `
            <tr style="border-bottom: 1px solid #f9f9f9;">
                <td style="padding: 10px 0; font-weight: 600;">ğŸ“… ${date}</td>
                <td style="padding: 10px 0; text-align: right; color: var(--dark); font-weight: 700;">${formatTime(minutesObj[date])}</td>
            </tr>
        `).join('');
    }

    function renderChart(minutesObj) {
        const canvas = document.getElementById('pomoChart');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        const labels = Object.keys(minutesObj).sort();
        const data = labels.map(l => minutesObj[l]);
        
        if (myChart) myChart.destroy();
        myChart = new Chart(ctx, {
            type: 'line',
            data: { labels, datasets: [{ 
                label: 'Thá»i gian há»c', 
                data, 
                borderColor: '#3498db', 
                backgroundColor: 'rgba(52, 152, 219, 0.2)',
                fill: true, 
                tension: 0.4 
            }] },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        min: labels[labels.length - 30] || labels[0],
                        max: labels[labels.length - 1]
                    },
                    y: { 
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                const h = Math.floor(value / 60);
                                const m = Math.floor(value % 60);
                                return h.toString().padStart(2, '0') + ":" + m.toString().padStart(2, '0');
                            }
                        }
                    }
                },
                plugins: {
                    zoom: {
                        pan: { enabled: true, mode: 'x', threshold: 10 }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return 'Thá»i gian: ' + formatTime(context.raw);
                            }
                        }
                    }
                }
            }
        });
    }

    function generateMockData() {
        const mock = {};
        for(let i=0; i<100; i++) {
            const d = new Date(); d.setDate(d.getDate() - i);
            mock[d.toLocaleDateString('sv-SE')] = Math.floor(Math.random()*300);
        }
        renderChart(mock);
        calculateStats(mock);
    }
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure TTS API Tester</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #2563eb; --bg: #f8fafc; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); padding: 20px; display: flex; justify-content: center; }
        .container { background: white; padding: 24px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); width: 100%; max-width: 500px; }
        h2 { margin-top: 0; color: var(--primary); font-size: 1.25rem; }
        
        .field { margin-bottom: 16px; }
        label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 6px; color: #475569; }
        
        input, select, textarea { 
            width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; 
            box-sizing: border-box; font-size: 14px; 
        }
        
        textarea { resize: vertical; min-height: 80px; }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        
        button { 
            width: 100%; padding: 12px; background: var(--primary); color: white; 
            border: none; border-radius: 8px; font-weight: 600; cursor: pointer;
            transition: opacity 0.2s; margin-top: 10px;
        }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .result-box { margin-top: 20px; padding-top: 20px; border-top: 1px solid #e2e8f0; }
        audio { width: 100%; height: 40px; }
        
        .url-preview { 
            font-size: 11px; color: #64748b; background: #f1f5f9; 
            padding: 8px; border-radius: 4px; word-break: break-all; margin-top: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>üé§ Azure TTS API Tester</h2>
    
    <div class="field">
        <label>VƒÉn b·∫£n (Text)</label>
        <textarea id="text" placeholder="Nh·∫≠p n·ªôi dung c·∫ßn ƒë·ªçc...">‰Ω†Â•Ω</textarea>
    </div>

    <div class="grid">
        <div class="field">
            <label>Ng√¥n ng·ªØ (Lang)</label>
            <select id="lang" onchange="updateVoices()">
                <option value="zh-CN">Trung Qu·ªëc (zh-CN)</option>
                <option value="ja-JP">Nh·∫≠t B·∫£n (ja-JP)</option>
                <option value="en-US">Anh M·ªπ (en-US)</option>
                <option value="vi-VN">Vi·ªát Nam (vi-VN)</option>
                <option value="ko-KR">H√†n Qu·ªëc (ko-KR)</option>
            </select>
        </div>
        <div class="field">
            <label>Gi·ªçng ƒë·ªçc (Voice)</label>
            <select id="voice"></select>
        </div>
    </div>

    <div class="grid">
        <div class="field">
            <label>T·ªëc ƒë·ªô (Rate)</label>
            <select id="rate">
                <option value="0.7">0.7 (R·∫•t ch·∫≠m)</option>
                <option value="0.85">0.85 (Ch·∫≠m)</option>
                <option value="1.0" selected>1.0 (B√¨nh th∆∞·ªùng)</option>
                <option value="1.2">1.2 (H∆°i nhanh)</option>
                <option value="1.5">1.5 (Nhanh)</option>
            </select>
        </div>
        <div class="field">
            <label>ƒê·ªãnh d·∫°ng (Format)</label>
            <select id="format">
                <option value="audio-16khz-32kbitrate-mono-mp3">MP3 (Nh·∫π)</option>
                <option value="audio-24khz-48kbitrate-mono-mp3">MP3 (Ch·∫•t l∆∞·ª£ng)</option>
            </select>
        </div>
    </div>

    <button id="playBtn" onclick="generateTTS()">üîä Ph√°t √¢m thanh</button>

    <div class="result-box" id="resultBox" style="display: none;">
        <label>Tr√¨nh ph√°t:</label>
        <audio id="audioPlayer" controls></audio>
        <div class="url-preview" id="urlPreview"></div>
    </div>
</div>

<script>
    const voices = {
        'zh-CN': [
            { id: 'zh-CN-XiaoxiaoNeural', name: 'N·ªØ - Xiaoxiao' },
            { id: 'zh-CN-YunxiNeural', name: 'Nam - Yunxi' }
        ],
        'ja-JP': [
            { id: 'ja-JP-NanamiNeural', name: 'N·ªØ - Nanami' },
            { id: 'ja-JP-KeitaNeural', name: 'Nam - Keita' }
        ],
        'en-US': [
            { id: 'en-US-JennyNeural', name: 'N·ªØ - Jenny' },
            { id: 'en-US-GuyNeural', name: 'Nam - Guy' }
        ],
        'vi-VN': [
            { id: 'vi-VN-HoaiMyNeural', name: 'N·ªØ - Ho√†i My' },
            { id: 'vi-VN-NamMinhNeural', name: 'Nam - Nam Minh' }
        ],
        'ko-KR': [
            { id: 'ko-KR-SunHiNeural', name: 'N·ªØ - Sun-Hi' },
            { id: 'ko-KR-InJoonNeural', name: 'Nam - In-Joon' }
        ]
    };

    function updateVoices() {
        const lang = document.getElementById('lang').value;
        const voiceSelect = document.getElementById('voice');
        voiceSelect.innerHTML = '';
        
        voices[lang].forEach(v => {
            const opt = document.createElement('option');
            opt.value = v.id;
            opt.textContent = v.name;
            voiceSelect.appendChild(opt);
        });
    }

    async function generateTTS() {
        const btn = document.getElementById('playBtn');
        const player = document.getElementById('audioPlayer');
        const resultBox = document.getElementById('resultBox');
        
        const params = new URLSearchParams({
            text: document.getElementById('text').value,
            lang: document.getElementById('lang').value,
            voice: document.getElementById('voice').value,
            rate: document.getElementById('rate').value,
            format: document.getElementById('format').value
        });

        const apiUrl = `/api/tts?${params.toString()}`;
        document.getElementById('urlPreview').textContent = `GET ${apiUrl}`;
        
        btn.disabled = true;
        btn.textContent = '‚è≥ ƒêang x·ª≠ l√Ω...';

        try {
            // Ch√∫ng ta g·ªçi tr·ª±c ti·∫øp URL v√†o src c·ªßa audio ƒë·ªÉ t·∫≠n d·ª•ng streaming c·ªßa browser
            player.src = apiUrl;
            resultBox.style.display = 'block';
            player.play();
        } catch (e) {
            alert('L·ªói khi g·ªçi API');
        } finally {
            btn.disabled = false;
            btn.textContent = 'üîä Ph√°t √¢m thanh';
        }
    }

    // Kh·ªüi t·∫°o l·∫ßn ƒë·∫ßu
    updateVoices();
</script>

</body>
</html>